#!/bin/bash
#PJM -L rscgrp=share
#PJM -L gpu=1
#PJM -g ga97

module load cuda/12.2
module load cudnn/8.9.4
module load cmake/3.24.0
module load gcc/8.3.1

source /work/ga97/a97009/env/g_3.12.0/222/bin/activate

today=$(date +'%y%m%d')

# [Datasets list] choose from these !
# BACE
# ClinTox
# CYP2C9
# CYP3A4
# hERG
# LD50
# SIDER
# Tox21
# ToxCast

seed=(42 222)
layer=(2 3)
scheduler_free=("False" "True")

for s in "${seed[@]}"; do
    for l in "${layer[@]}"; do
        for scl in "${scheduler_free[@]}"; do
            
            if [ "$scl" == "True" ]; then
                optim="RAdamScheduleFree"
            else
                optim="AdamW"
            fi
            
            python /work/ga97/a97009/WORKSPACE/MolKAN/molkan/experiments/FourierKAN/TfVAE_enc/general_experiments_largehidden.py \
                --note hERG-FourierKAN${l}layer-${optim}-seed${s} \
                --datasets hERG \
                --label_columns Y \
                --results_dirname ${today}_grids_batch_LOWlr_${optim}_${l}layer_largehidden_seed${s} \
                --seed $s \
                --train True \
                --mode classification \
                --num_epochs 500 \
                --layer $l \
                --num_grids 1,2,4,6,8 \
                --batch_size 4,16,64,256,1024 \
                --lr 5.0e-3,3.0e-3,5.0e-4,3.0e-4 \
                --lambda 0 \
                --scheduler_free $scl \
                --metrics accuracy,AUROC,sensitivity,precision,F1,MCC \
                --num_workers 9 \

        done
    done
done